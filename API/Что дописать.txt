var в локальных переменных
после else обрабатывать, как будто это новая строчка. 
